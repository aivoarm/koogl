extends layout

block content

    div#userslog(style="float:left;width:200px;height:300px;padding:10px;")
     b USERS
      
      input#user(style="width:100px;")
      div#users
       
       
    
    div(style="float:left; display:block;width:500px;height:20px; padding:10px")
        input#data(style="width:400px;")
        input#datasend(type="button" value="send")
    div(style="float:left; display:block;width:500px;height:260px; overflow-y:scroll; padding:10px; border:1px solid black")
        div#conversation
    div(style="float:right; display:block;width:100px;height:260px; ")    
        input#disconnect(type="button" value="I am done" style="width:80px;")  
        input#reconnect(type="button" value="go back" style="width:80px;;")    
    script(type='text/javascript').
        var socket = io.connect(null);
        
        socket.on('connect', function(){
           
        
        
        socket.on('updatechat', function (username, data) {
            $('#conversation').append('<b>'+username + ':</b> ' + data + '<br>');
        });

        socket.on('updateusers', function(data) {
            $('#users').empty();
                $.each(data, function(key, value) {
                    $('#users').append('<div>' + key + '</div>');
            });
        });

        });

        $(function(){
        
        $('#datasend').click( function() {
            var message = $('#data').val();
                //alert(message)
        $('#data').val('');
            socket.emit('sendchat', message);
        });

        $('#data').keypress(function(e) {
            if(e.which == 13) {
                $(this).blur();
            $('#datasend').focus().click();
            }
        });
        
        $('#user').focusout(function(e){
            //alert('asdasd')
                socket.emit('adduser', $(this).val());
            });
            
       
            //alert('asdasd')
        
        $('#disconnect').click(function(e){
               $('#users').html('U are out')
                socket.emit('discon', 'hey');
                socket.disconnect();
                    
        });
         
         
        $('#reconnect').click(function(e){
               
                socket.emit('reconnect');
                socket.reconnect();
                    
        });
                
            
        });


       
        
        
             